# :computer: rootme :octocat:
Здесь Вы можете увтдеть решения заданйи с платформы rootme.
## Категории:
- [Web категория](#WEBкатегория)

## WEB категория
Я совместила две отдельных категории Веба в одну, т.к. - обычно они представляются одной категорией.
Совмещены будут 'Веб - сервер' и 'Веб - Клиент'.
#### ___Описание заданий с категорий___:
Эти задачи сталкивают вас с использованием языков сценариев и программирования на стороне клиента. В основном это скрипты, которые нужно анализировать и понимать. Это позволит вам изучить языки, которые широко используются в Интернете.
Эти задачи предназначены для обучения пользователей работе с HTML, HTTP и другими серверными механизмами. Следующая серия задач будет способствовать лучшему пониманию таких методов, как : Базовая работа нескольких механизмов аутентификации, обработка данных форм, внутренняя работа веб-приложений и т.д.
# 
# 
### `HTML - Source code`

Подсказка дается уже в самом название. Нам нужно зайти в код страницы. Попробуем поискать спрятанный флаг (пароль) и наткнемся на ЭТО:
![код страницы](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/first_task.png)
# 
# 
### `HTTP - User-agent`

Название снова подсказыает нам на то место, куда смотреть. Поэтому мы должны воспользоваться Burp Suite и перехватить запрос с сайта. Теперь мы видим другой User-Agent (то, с какого браузера мы зашли). Меняем его на "admin":
![перехваченый запрос](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/2task.png)
Форвардим запрос и перезагружаем страницу. Или кидаем его в Repeater и наживаем "Send". Покажу пример с Repeater:
![перехваченый запрос](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/2_1task.png)

# 
# 
### `Java - Server-side Template Injection`
Название задания говорит нам о том, что это шаблонная инъекция или же 'template injection'. Мы видим форму и сразу понимаем что нужно сделать что-то с ней. Ищем разные пэйлоады. И по методологии, пытаемся подобрать нужный нам шаблон. Я использовала этот репозиторий:
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md
![перехваченый запрос](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/ssti_1.png)

--тут позже допишу--
# 
# 
### `PHP - Serialization`

![перехваченый запрос](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/php_ser.png)

В задании нужно получить доступ админа. Поэтому запомним это и перейдем на страницу задания. Тут по условию вводим данные гостя (guest) и не забываем нажать галочку о том, чтобы нас запомнили, это понадобится для создания нашей сессии. Собственно, сама сессия нужна для ее подмены под данные суперадмина.

![перехваченый запрос](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/php_ser_2.png)

Теперь видим, что мы действительно смогли зайти под данными гостя (guest). Следующим шагом предлагаю перейти в куки, то место, где создалась наша сессия. Если что, утилита называется "EditThisCookie" (та, что на скрине).

![перехваченый запрос](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/php_ser_3.png)

Тут сразу видно, 
# 
# 
##
## 
##
##
##
##
##
##
##
##
## Networks категория
#### ___Описание заданий с категорий___:

Следующий набор проблем касается сетевого трафика, включая различные протоколы. Вам необходимо проанализировать захваты пакетов для решения этих проблем.
Предпосылки:
Знание инструмента анализа сетевых захватов.
Знание наиболее распространенных сетевых протоколов.
# 
# 
### `FTP - authentication`
Мы работаем с файлов .pcap, а это означате что мы можем открыть его в Wireshark. По условию нам нужно работать с FTP и найти пароль.
![скрин С ftp пакетом](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/wire1.png)
Так что находим самый первый пакет FTP и наживаем TCP-stream. А теперь ищем место с паролем.
![скрин с ответом](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/wire1-2.png)
# 
#
### `TELNET - authentication`
Здесь делаем практически такой же алгоритм, что и в предыдущем задании (FTP - authentication). 
![скрин с ответом](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/wire1-2.png)
# 
# 
### `ETHERNET - frame`
Нам дается .txt файл и открыв его, мы видим то, что это hex'ы. Поэтому открываем любой декодер, в моем случае это CyberShef. И переводим hex'ы в текст.
![скрин с ответом](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/network_cyber_1.png)
Теперь мы видим кодировку base64, и опять же, просто переводим в обычный текст. Заливаем ответ.
#
#
### `Twitter authentication`
Здесь нам дается файл расширения .pcap, а значит интуитивно заходим в Wireshark. И видим всго один пакет.
![скрин с ответом](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/network_wire_2.png)

Выбираем "follow TCP" и нам открывается такое окно. Как мы видим, у запроса есть поле авторизации. Копируем текст оттуда и переводим base64 в текст.
#
#
### `Bluetooth - Unknown file`
В описании дается понять, что мы имеем дело с файлом Bluetooth. Воспользовавшись командой "cat", мы можем посмотреть то, что находится внутри файла и увидим расширение BTSnoop. Теперь мы можем воспользоваться Wireshark, так как он поддерживает работу с файлами связанными с Bluetooth. Теперь заходим во вкладку "Wireless" и переходим в "Bluetooth devices".

![что нам выдает файл](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/device.png)

А теперь просто переводим в sha1, но ___НЕ ЗАБЫВАЕМ ПЕРЕВЕСТИ В ВЕРХНИЙ РЕГИСТР БУКВЫ MAC АДРЕССА___.
#
#
### `DNS - zone transfert`
Здесь мы работаем с DNS, а если быть точнее, нам дается: хост, порт и домен. Значит в голову приходит команда dig.

![результат команды dig](https://github.com/YanaGerasimenko/ctf-writeups/blob/main/rootme/networks_dns.png)

Теперь осталось создать нормальную команду, чтобы извлечь то, что нам нужно. Поэтому предлагаю использовать axfr, которая даст нам расширенную информацию о запрашиваемом домене. Осталось только забрать флаг.
